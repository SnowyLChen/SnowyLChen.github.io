---
title: 二级缓存
date: 2019-11-03 12:24:23
tags: cache
categories: cache
---

## 二级缓存（cache）

如何开启二级缓存

测试类：

```java
    @Test
    public void t2(){
        SqlSession ss=mybatisUtil.getSession();
        SqlSession ss2=mybatisUtil.getSession();
        PeopleMapper mapper = ss.getMapper(PeopleMapper.class);
        PeopleMapper mapper2 = ss2.getMapper(PeopleMapper.class);
        mapper.search(1);
        ss.close();
        mapper2.search(1);
        ss2.close()
    }	
```

mybatis.xml配置中写：

```java
   <settings>
    <!--下划线风格转化为驼峰风格-->
       <!--开启二级缓存-->
       <setting name="cacheEnabled" value="true"/>
   </settings>
```

在mapper.xml中写：

```java
 <cache
    	  /**LRU – 最近最少使用：移除最长时间不被使用的对象。
		  *FIFO – 先进先出：按对象进入缓存的顺序来移除它们。
		  *SOFT – 软引用：基于垃圾回收器状态和软引用规则移除对象。
		  *WEAK – 弱引用：更积极地基于垃圾收集器状态和弱引用规则移除对象。默认的清除策略是 LRU。*/
           	eviction="FIFO"
     	  //flushInterval（刷新间隔）属性可以被设置为任意的正整数，设置的值应该是一个以毫秒为单位的合理时间量。 默认情况是不设置，也就是没有刷新间隔，缓存仅仅会在调用语句时刷新。
     		flushInterval="60000"
     	  //size（引用数目）属性可以被设置为任意正整数，要注意欲缓存对象的大小和运行环境中可用的内存资源。默认值是 1024。
            size="512"
            readOnly="true"/>
```

**提示** 二级缓存是事务性的。这意味着，当 SqlSession 完成并提交时，或是完成并回滚，但没有执行 flushCache=true 的 insert/delete/update 语句时，缓存会获得更新